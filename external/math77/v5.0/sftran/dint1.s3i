      SUBROUTINE DINT1 (A,B,ANSWER,WORK,IOPT)
num73(999999)
noindent
C     .  Copyright (C) 1989, California Institute of Technology.
C     .  All rights reserved.  U. S. Government sponsorship under
C     .  NASA contract NAS7-918 is acknowledged.
c>> 1994-10-19 DINT1  Krogh  Changes to use M77CON
c>> 1994-07-07 DINT1  Snyder set up for CHGTYP.
C>> 1993-05-18 DINT1  Krogh -- Changed "END" to "END PROGRAM"
C>> 1991-09-20 DINT1  Krogh converted '(1)' dimensioning to '(*)'.
C>> 1987-11-19 DINT1  Snyder  Initial code.
C
c--D replaces "?": ?INT1, ?INTA, ?intc, ?intec, ?INTF, ?INTOP, ?INTNC
C     ******************************************************************
C
C     THIS SUBROUTINE ATTEMPTS TO CALCULATE THE INTEGRAL OF A FUNCTION
C     OVER THE INTERVAL A TO B TO WITHIN A TOLERANCE LEVEL SPECIFIED
C     BY THE USER.  THE FUNCTION IS PROVIDED BY THE USER VIA A
C     SUBPROGRAM REFERENCED BY CALL DINTF (F,X,IFLAG), OR BY REVERSE
C     COMMUNICATION.  IN THE CASE OF ONE-DIMENSIONAL QUADRATURE, IFLAG
C     IS ALWAYS ZERO.  ALL ABSCISSAE ARE WITHIN THE INTERVAL OF
C     INTEGRATION.
C
C     THE RESULT IS OBTAINED USING QUADRATURE FORMULAE DUE TO
C     T. N. L. PATTERSON, MATHEMATICS OF COMPUTATION, VOLUME 22,
C     PAGES 847-856, 1968.
C
C     *****    WARNING   ***********************************************
C
C     THE RELIABILITY AND EFFICIENCY OF THIS PROGRAM ARE STRONGLY
C     INFLUENCED BY DISCONTINUITIES IN THE FUNCTION OR IT'S
C     DERIVATIVES, INTEGRABLE SINGULARITIES ON THE INTERVAL OF
C     INTEGRATION, AND NON-INTEGRABLE SINGULARITIES NEAR THIS INTERVAL
C     (INCLUDING COMPLEX VALUES).  THE EFFICIENCY AND RELIABILITY
C     OF INTEGRATING SUCH FUNCTIONS MAY BE GREATLY IMPROVED BY MANUALLY
C     SUBDIVIDING THE INTERVAL OF INTEGRATION AT THE DISCONTINUITY,
C     SINGULARITY OR CLOSEST POINT TO A POLE, AND SUMMING THE ANSWERS.
C     A CHANGE OF VARIABLE TO ELIMINATE OR REDUCE THE STRENGTH OF THE
C     SINGULARITY WILL SIGNIFICANTLY IMPROVE PERFORMANCE.
C
C     *****    FORMAL ARGUMENTS    *************************************
C
C A       LOWER LIMIT OF INTERVAL OF INTEGRATION.
      DOUBLE PRECISION A
C B       UPPER LIMIT OF INTERVAL OF INTEGRATION.
      DOUBLE PRECISION B
C ANSWER  IS THE ESTIMATE OF THE INTEGRAL.  WHEN REVERSE COMMUNICATION
C         IS SPECIFIED IT IS USED TO PASS FUNCTION VALUES FROM
C         THE USER PROGRAM TO DINTA.
      DOUBLE PRECISION ANSWER
C WORK    IS A WORKING STORAGE VECTOR USED BY OPTIONS (SEE IOPT).
C         WHEN THE INTEGRATION IS COMPLETE, WORK(1) CONTAINS THE
C         ESTIMATED ABSOLUTE ERROR.  WHEN REVERSE COMMUNICATION
C         IS SPECIFIED, WORK(1) IS USED TO PASS ABSCISSAE FROM
C         DINTA TO THE USER PROGRAM.
      DOUBLE PRECISION WORK(*)
C IOPT    IS A VECTOR OF INTEGERS USED TO RETURN THE STATUS AND TO
C         SPECIFY OPTIONS.
      INTEGER IOPT(*)
C         IOPT(1) IS USED TO RETURN A STATUS INDICATOR TO THE USER.
C         VALUES OF THE STATUS INDICATOR ARE
C         -1 - NORMAL TERMINATION, EITHER THE ABSOLUTE OR THE RELATIVE
C              ERROR CRITERIA ARE SATISFIED.
C         -2 - NORMAL TERMINATION, NEITHER THE ABSOLUTE NOR THE
C              RELATIVE ERROR CRITERIA ARE SATISFIED, BUT THE RELATIVE
C              TO THE OBTAINABLE ERROR CRITERION IS SATISFIED.
C         -3 - NORMAL TERMINATION, BUT NONE OF THE ERROR CRITERIA ARE
C              SATISFIED.
C         +4 - BAD IOPT VALUE.
C         +5 - TOO MANY FUNCTION VALUES NEEDED.
C         +6 - APPARENT NON-INTEGRABLE SINGULARITY NEAR ANSWER.
C         ENTRIES IN IOPT STARTING AT IOPT(2) ARE DESCRIBED BELOW.
C         IOPT(I)    ENTRY IN IOPT(I) MEANS
C           0        NO MORE OPTIONS, BEGIN INTEGRATION.
C           1        IOPT(I+1) CONTAINS THE UNIT NUMBER FOR OUTPUT.
C           2        IOPT(I+1) IS DIAGNOSTIC PRINT LEVEL
C                    0 - NO PRINTING
C                    1 - MINIMUM PRINTING - ERROR MESSAGES (DEFAULT)
C                    2 - PANEL BOUNDARIES AND ANSWERS
C                    3 - ERROR ESTIMATES FOR EACH QUADRATURE FORMULA
C                    4 - DETAILED OUTPUT (DIFFERENCE LINES, ETC).
C           3        WORK(IOPT(I+1)) CONTAINS THE ABSOLUTE TOLERANCE,
C                    WORK(IOPT(I+1)+1) CONTAINS TOLERANCE RELATIVE TO
C                    THE LOCALLY OBTAINABLE PRECISION, AND
C                    WORK(IOPT(I+1)+2) CONTAINS TOLERANCE RELATIVE TO
C                    THE VALUE OF THE INTEGRAL.  THE TOLERANCE RELATIVE
C                    TO THE LOCALLY OBTAINABLE PRECISION IS SPECIFIED AS
C                    THE FRACTION OF LOCALLY OBTAINABLE DIGITS THAT ARE
C                    PERMITTED TO BE WRONG, AND IS INTERNALLY BOUNDED
C                    BETWEEN 0.0 AND 1.0.  IF ANY OF THE ERROR CONTROL
C                    CRITERIA ARE SATISFIED, THE ANSWER IS ACCEPTED.  IF
C                    THIS OPTION IS NOT USED, THE ABSOLUTE AND RELATIVE
C                    TOLERANCES ARE SET TO ZERO, AND THE TOLERANCE
C                    RELATIVE TO THE LOCALLY OBTAINABLE PRECISION IS SET
C                    TO 0.25.
C           4        WORK(IOPT(I+1)) CONTAINS ABSOLUTE ERROR COMMITTED
C                    COMPUTING F.  WORK(IOPT(I+1)) MAY BE CHANGED DURING
C                    THE INTEGRATION.
C           5        WORK(IOPT(I+1)) CONTAINS RELATIVE ERROR EXPECTED TO
C                    BE COMMITTED COMPUTING F.  CHANGES TO THIS VALUE
C                    DURING INTEGRATION WILL NOT BE DETECTED.
C           6        USE REVERSE COMMUNICATION -
C                    CALL DINT1 (A,B,ANSWER,WORK,IOPT)
C                  1 CALL DINTA (ANSWER,WORK,IFLAG)
C                    IF (IFLAG.NE.0) GO TO 2
C                    ANSWER=F(WORK(1))
C                    GO TO 1
C                  2 CONTINUE
C                    IFLAG AT THIS POINT CONTAINS THE SAME VALUE AS
C                    THE STATUS FLAG WOULD (IF SELECTED) FOR THE
C                    FORWARD COMMUNICATION METHOD.
C           7        SET MINIMUM INDEX OF QUADRATURE FORMULA TO USE
C                    BEFORE SUBDIVISION TO IOPT(I+1).
C           8        NO EFFECT.  MAY BE USED TO PASS INFORMATION INTO
C                    DINTF.  INCREMENT I BY 2.
C           9        IOPT(I+1) IS THE MAXIMUM NUMBER OF FUNCTION VALUES
C                    TO USE TO INTEGRATE THE ENTIRE PROBLEM.  IF
C                    IOPT(I+1) .LE. 0, THE NUMBER OF FUNCTION VALUES
C                    IS NOT CONTROLLED.
C          10        IOPT(I+1) IS USED TO RETURN THE NUMBER OF FUNCTION
C                    VALUES USED TO INTEGRATE THE ENTIRE PROBLEM.
C          11        WORK(IABS(IOPT(I+1))) IS THE LOCATION OF A
C                    SINGULARITY OR DISCONTINUITY.  IF THE LOCATION IS
C                    INSIDE THE INTERVAL, THE INTERVAL WILL BE
C                    IMMEDIATELY SUBDIVIDED.  IF IOPT(I+1).GT.0, A
C                    T**2 SUBSTITUTION BASED AT WORK(...) WILL BE USED.
C                    IF IOPT(I+1) .LT. 0 A T**4 SUBSTITUTION WILL BE
C                    USED.  IF IOPT(I+1) .EQ. 0, NO SUBSTITUTION WILL BE
C                    USED.
C          12        WORK(IOPT(I+1)) CONTAINS THE ABSOLUTE ERROR IN THE
C                    LOWER LIMIT OF THE CURRENT DIMENSION.  THE ERROR IN
C                    THE UPPER LIMIT IS IN WORK(IOPT(I+1)+1).
C          13        IS USED ONLY FOR MULTIDIMENSIONAL PROBLEMS.
C
C     ALL OPTIONS ARE SET TO THEIR NOMINAL VALUES BEFORE THE OPTION
C     VECTOR IS PROCESSED.
C
C     *****    EXTERNAL REFERENCES     *********************************
C
C DINTA   TO PERFORM THE INTEGRATION.
C DINTOP  TO SET OPTIONS.
C
C     *****    COMMON STORAGE     **************************************
C
C                    Common blocks are: DINTNC, DINTC, and DINTEC
include (dintc)
C
include (dintec)
indent
C
C     *****    PROCEDURES     ******************************************
C
      WHERE=0
      NDIM=1
      KDIM=1
      NFEVAL=0
      CALL DINTOP (IOPT,WORK)
      IF (IOPT(1).EQ.0) THEN
C
C        CALL DINTA TO DO THE INTEGRATION.
C
         AINIT=A
         BINIT=B
         IF (REVERS.EQ.0) CALL DINTA (ANSWER,WORK,IOPT)
      END IF
      RETURN
C
      END PROGRAM
