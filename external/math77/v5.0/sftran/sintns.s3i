      SUBROUTINE SINTNS (JUMPTO)
num73(999999)
C     .  Copyright (C) 1989, California Institute of Technology.
C     .  All rights reserved.  U. S. Government sponsorship under
C     .  NASA contract NAS7-918 is acknowledged.
C>> 1994-11-14 SINTNS  Krogh  Declared all vars.
c>> 1994-10-19 SINTNS  Krogh  Changes to use M77CON
c>> 1994-07-07 SINTNS  Snyder set up for CHGTYP.
C>> 1993-05-18 SINTNS  Krogh -- Changed "END" to "END PROGRAM"
C>> 1987-11-19 SINTNS Snyder  Initial code.
C
C     REDUCE OR INCREASE NSUB, DEPENDING ON JUMPTO.  VALUES OF JUMPTO
C     ARE GIVEN BY THE PARAMETERS NSRA, NSRB, NSIA, NSIB IN SINTA.
C
c--S replaces "?": ?INTA, ?INTC, ?INTEC, ?INTNS, ?INTSM
C
C     *****     EXTERNAL REFERENCES     ********************************
C
C SINTSM  TO CALCULATE THE MINIMUM STEPSIZE.
      REAL             SINTSM
C
C     *****     LOCAL VARIABLES     ************************************
C
C TDECR   IS AN ARITHMETIC STATEMENT FUNCTION DEFINED BELOW.
      REAL             TDECR
C TINCR   IS AN ARITHMETIC STATEMENT FUNCTION DEFINED BELOW.
      REAL             TINCR
C ZL1     IS AN ARGUMENT OF ARITHMETIC STATEMENT FUNCTIONS.
      REAL             ZL1
      INTEGER JUMPTO
C
C     *****     COMMON VARIABLES     ***********************************
C
C ALOCAL  IS EQUIVALENT TO /SINTC/ LOCAL(1).
C BLOCAL  IS EQUIVALENT TO /SINTC/ LOCAL(2).
      REAL             ALOCAL, BLOCAL
C FATAS, FATBS
C         ARE EQUIVALENCED TO FATS.
      LOGICAL FATAS, FATBS
C
include (sintc)
C
include (sintec)
C
C     *****     EQUIVALENCE STATEMENTS     *****************************
C
      EQUIVALENCE (LOCAL(1),ALOCAL), (LOCAL(2),BLOCAL)
      EQUIVALENCE (FATS(1),FATAS), (FATS(2),FATBS)
C
C     *****     STATEMENT FUNCTIONS     ********************************
C
C TDECR   IS USED TO TRANSFORM AN ABSCISSA FROM THE CURRENT COORDINATE
C         SYSTEM TO ONE IN WHICH NSUB IS DECREMENTED BY A FACTOR OF 2.
      TDECR(ZL1)=TA+(ZL1-TA)*((ZL1-TA)/TB)
C TINCR   IS USED TO TRANSFORM AN ABSCISSA FROM THE CURRENT COORDINATE
C         SYSTEM TO ONE IN WHICH NSUB IS INCREMENTED BY A FACTOR OF 2.
      TINCR(ZL1)=TA+SIGN(SQRT(ABS(TB*(ZL1-TA))),TB)
C
C     *****     EXECUTABLE STATEMENTS     ******************************
C
      GO TO (2670,2680,2690,2700), JUMPTO
C
C     REDUCE NSUB
C
2670  BLOCAL=TDECR(BLOCAL)
2680  ALOCAL=TDECR(ALOCAL)
      WORRY(PART)=TDECR(WORRY(PART))
      ABSCIS=TDECR(START(PART)+SIGN(STEP(PART),TB))
      START(PART)=TDECR(START(PART))
      NSUB=2*(NSUB/4)
      GO TO 2710
C
C     INCREASE NSUB
C
2690  BLOCAL=TINCR(BLOCAL)
2700  ALOCAL=TINCR(ALOCAL)
      WORRY(PART)=TINCR(WORRY(PART))
      ABSCIS=TINCR(START(PART)+SIGN(STEP(PART),TB))
      START(PART)=TINCR(START(PART))
      NSUB=MAX0(NSUB+NSUB,2)
C
2710  FSAVED=.FALSE.
      FATAS=.FALSE.
      FATBS=.FALSE.
      ENDPTS=1
      STEP(PART)=SIGN(ABSCIS-START(PART),STEP(PART))
      DELTA=ABS(BLOCAL-ALOCAL)
      ABSDIF=0.5e0*DELTA
      TLEN=ABS(END(1)-START(1))
      IF (PART.EQ.2) TLEN=TLEN+ABS(END(2)-START(2))
      IF (DISCHK.EQ.0) DISCHK=-1
      DELMIN=SINTSM(ALOCAL)
C
      RETURN
C
      END PROGRAM
